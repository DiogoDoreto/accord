function anonymous(locals, escape, include, rethrow) {
rethrow = rethrow || function rethrow(err, str, filename, lineno){
  var lines = str.split('\n')
    , start = Math.max(lineno - 3, 0)
    , end = Math.min(lines.length, lineno + 3);

  // Error context
  var context = lines.slice(start, end).map(function(line, i){
    var curr = i + start + 1;
    return (curr == lineno ? ' >> ' : '    ')
      + curr
      + '| '
      + line;
  }).join('\n');

  // Alter exception message
  err.path = filename;
  err.message = (filename || 'ejs') + ':'
    + lineno + '\n'
    + context + '\n\n'
    + err.message;

  throw err;
};
escape = escape || function (markup) {
  var chars = {
        '&': '&amp;'
      , '<': '&lt;'
      , '>': '&gt;'
      , '"': '&quot;'
      , '\'': '&#39;'
    }
  , str = String(markup);
  Object.keys(chars).forEach(function (k) {
    str = str.replace(new RegExp(k, 'g'), chars[k]);
  });
  return str;
};
var __line = 1, __lines = "Woah look, a <%= thing %>", __filename = undefined; try {var buf = []; var __output = ""; with (locals) { ;__output += "Woah look, a ";;__output += escape(thing);} buf = [__output]; return __output.trim();} catch (e) { rethrow(e, __lines, __filename, __line); }
}